#!/bin/bash
# Script to scale Django app deployment and monitor performance

# Scale the deployment to 3 replicas
echo "Scaling Django app to 3 replicas..."
kubectl scale deployment django-app --replicas=3

# Wait for pods to start
sleep 5

# Verify the running pods
echo "Current running pods:"
kubectl get pods

# Load testing using wrk (make sure wrk is installed)
# Replace <APP_SERVICE_URL> with your Django service URL or ClusterIP
echo "Performing load test..."
wrk -t4 -c100 -d30s http://<APP_SERVICE_URL>/

# Monitor resource usage
echo "Monitoring resource usage..."
kubectl top pods
